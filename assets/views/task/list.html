<div page-header>
    <h4 ng-hide="loadParams.iterationCount">List of tasks</h4>
    <h4 ng-show="loadParams.iterationCount">Tasks repeated {{ loadParams.iterationCount }} and more times</h4>
    <!--<h6>{{ formParams }}</h6>-->
    <!--<h6>{{ loadParams }}</h6>-->
</div>

<div class="well">
    <form class="form-horizontal form-small">
        <div class="control-group">
            <label class="control-label" for="processId">ProcessId:</label>
            <div class="controls">
                <input id="processId" type="text" ng-model="formParams.processId" ng-disabled="formParams.iterationCount"
                       class="input-xlarge" on-enter="search()"/>
            </div>
        </div>
        <div class="control-group">
            <label class="control-label" for="taskId">TaskId:</label>
            <div class="controls">
                <input id="taskId" type="text" ng-model="formParams.taskId" ng-disabled="formParams.iterationCount"
                       class="input-xlarge" on-enter="search()"/>
            </div>
        </div>
        <div class="control-group">
            <label class="control-label" for="iterationCount">Task attempts:</label>
            <div class="controls">
                    <input id="iterationCount" type="number" min="0" ng-model="formParams.iterationCount"
                           class="input-mini" on-enter="search()"/>
                    <button class="btn" ng-click="search()">Search</button>
            </div>
        </div>
    </form>
</div>

<page-message></page-message>

<div class="well">
    <list-reload model="tasksResource">
    </list-reload>

    <table class="table table-striped table-hover table-bordered table-items">
        <thead>
            <tr>
                <th style="width: 50px">â„–</th>
                <th>UUID</th>
                <th>Process UUID</th>
                <th>Type</th>
                <th>ActorId</th>
                <th>Method</th>
                <th>Arguments</th>
            </tr>
        </thead>

        <tbody>
            <tr ng-repeat="task in tasksModel.items">
                <td>
                    {{ tasksModel.$startIndex + $index }}
                </td>
                <td>
                    <a ui-sref="task({taskId: task.taskId, processId:task.processId})" style="cursor: pointer;" >
                            {{task.taskId}}</a>
                </td>
                <td>
                    <a ui-sref="process({processId:task.processId})"  style="cursor: pointer;">
                            {{task.processId}}</a>
                </td>
                <td>
                    <b>{{task.type}}</b>
                </td>
                <td>
                    <span ng-bind-html="task.actorId | lineWrap"></span>
                </td>
                <td>
                    <b>{{task.method}}</b>
                </td>
                <td>
                    <button ng-show="task.args && task.args.length"
                            ng-click="showArgs(task)" class="btn btn-mini"
                            popover="Show arguments"
                            popover-trigger="mouseenter">
                        <i class="icon-info-sign"></i>
                    </button>
                </td>
            </tr>
        </tbody>

        <tfoot>
            <tr>
                <td colspan="7">
                    <list-paginator model="tasksModel">
                    </list-paginator>
                </td>
            </tr>
        </tfoot>

    </table>

    <div>Total: <b>{{tasksModel.totalCount || tasksModel.items.length}}</b> tasks</div>
</div>